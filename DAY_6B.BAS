1000 REM Advent of Code 2022, Day 5 Part 1
1010 DEFINT A-Z: WSIZE=14: DIM TAG(WSIZE)
1020 GOTO 1150
1030 '
1040 REM Valid Tag
1050 VALID=0
1060 FOR I=1 TO WSIZE-1
1070  TI=TAG(I)
1080  FOR J=I+1 TO WSIZE
1090   IF TI=TAG(J) THEN RETURN
1100  NEXT J
1110 NEXT I
1120 VALID=1
1130 RETURN
1140 '
1150 REM Main
1160 INPUT "File";F$
1170 OPEN F$ FOR INPUT AS #1
1180 WHILE NOT EOF(1)
1190  FOR I=1 TO WSIZE: TAG(I)=ASC(INPUT$(1,1)): NEXT I: REM Prime
1200  N=WSIZE
1210  WHILE TAG(WSIZE)<>13
1220   GOSUB 1040: IF VALID THEN PRINT "MARKER=";N: LINE INPUT #1,T$: GOTO 1280
1230   FOR I=2 TO WSIZE: TAG(I-1)=TAG(I): NEXT I
1240   TAG(WSIZE)=ASC(INPUT$(1,1))
1250   N=N+1
1260  WEND
1270  PRINT "NO MARKER FOUND"
1280 WEND
1290 END
