1000 REM Advent of Code 2022, Day 5 Part 1
1010 DIM TAG$(4)
1020 GOTO 1140
1030 '
1040 REM Valid Tag
1050 VALID=0
1060 FOR I=1 TO 3
1070  FOR J=I+1 TO 4
1080   IF I<>J AND TAG$(I)=TAG$(J) THEN RETURN
1090  NEXT J
1100 NEXT I
1110 VALID=1
1120 RETURN
1130 '
1140 REM Main
1150 INPUT "File";F$
1160 OPEN F$ FOR INPUT AS #1
1170 WHILE NOT EOF(1)
1180  FOR I=1 TO 4: TAG$(I)=INPUT$(1,1): NEXT I: REM Prime
1190  N=4
1200  WHILE TAG$(4)<>CHR$(13)
1210   GOSUB 1040: IF VALID THEN PRINT "MARKER=";N: LINE INPUT #1,T$: GOTO 1270
1220   FOR I=1 TO 3: TAG$(I)=TAG$(I+1): NEXT I
1230   TAG$(4)=INPUT$(1,1)
1240   N=N+1
1250  WEND
1260  PRINT "NO MARKER FOUND"
1270 WEND
1280 END
